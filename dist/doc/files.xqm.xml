<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0">
  <xqdoc:control>
    <xqdoc:date>2016-02-22T15:20:29.361Z</xqdoc:date>
    <xqdoc:version>1.1</xqdoc:version>
  </xqdoc:control>
  <xqdoc:module type="library">
    <xqdoc:uri>quodatum.doc.file</xqdoc:uri>
    <xqdoc:name>files.xqm</xqdoc:name>
    <xqdoc:comment>
      <xqdoc:description>file system tools</xqdoc:description>
      <xqdoc:author>Andy Bunce</xqdoc:author>
      <xqdoc:version>0.2</xqdoc:version>
    </xqdoc:comment>
  </xqdoc:module>
  <xqdoc:namespaces>
    <xqdoc:namespace prefix="df" uri="quodatum.doc.file"/>
  </xqdoc:namespaces>
  <xqdoc:imports/>
  <xqdoc:variables>
    <xqdoc:variable>
      <xqdoc:name>df:base</xqdoc:name>
      <xqdoc:comment>
        <xqdoc:description>path to webapps with trailing slash</xqdoc:description>
      </xqdoc:comment>
      <xqdoc:type>xs:string</xqdoc:type>
    </xqdoc:variable>
  </xqdoc:variables>
  <xqdoc:functions>
    <xqdoc:function arity="2">
      <xqdoc:comment>
        <xqdoc:description>default file list skip data</xqdoc:description>
      </xqdoc:comment>
      <xqdoc:name>df:keep-files</xqdoc:name>
      <xqdoc:signature>declare function df:keep-files($f as xs:string, $s as xs:string) as xs:string?</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>f</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
        <xqdoc:parameter>
          <xqdoc:name>s</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type occurrence="?">xs:string</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="2">
      <xqdoc:comment>
        <xqdoc:description>list of files matching $glob below $src</xqdoc:description>
        <xqdoc:param>$src full path to folder eg "file:/C:/sss/"</xqdoc:param>
      </xqdoc:comment>
      <xqdoc:name>df:dir</xqdoc:name>
      <xqdoc:signature>declare function df:dir($src as xs:string, $glob as xs:string) as xs:string*</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>src</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
        <xqdoc:parameter>
          <xqdoc:name>glob</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type occurrence="*">xs:string</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="1">
      <xqdoc:comment>
        <xqdoc:description>true path from segment</xqdoc:description>
      </xqdoc:comment>
      <xqdoc:name>df:webapp-expath</xqdoc:name>
      <xqdoc:signature>declare function df:webapp-expath($app as xs:string) as element()?</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>app</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type occurrence="?">element()</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="1">
      <xqdoc:comment>
        <xqdoc:description>true path from segment</xqdoc:description>
      </xqdoc:comment>
      <xqdoc:name>df:webpath</xqdoc:name>
      <xqdoc:signature>declare function df:webpath($path as xs:string) as xs:string</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>path</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type>xs:string</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="0">
      <xqdoc:comment>
        <xqdoc:description>list of all web applications</xqdoc:description>
      </xqdoc:comment>
      <xqdoc:name>df:apps</xqdoc:name>
      <xqdoc:signature>declare function df:apps() as xs:string*</xqdoc:signature>
      <xqdoc:return>
        <xqdoc:type occurrence="*">xs:string</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="3">
      <xqdoc:comment>
        <xqdoc:description>serialize a file object</xqdoc:description>
      </xqdoc:comment>
      <xqdoc:name>df:file</xqdoc:name>
      <xqdoc:signature>declare function df:file($dir as item()*, $name as xs:string, $isFolder as xs:boolean) as element(_)</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>dir</xqdoc:name>
          <xqdoc:type occurrence="*">item()</xqdoc:type>
        </xqdoc:parameter>
        <xqdoc:parameter>
          <xqdoc:name>name</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
        <xqdoc:parameter>
          <xqdoc:name>isFolder</xqdoc:name>
          <xqdoc:type>xs:boolean</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type>element(_)</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="1">
      <xqdoc:comment>
        <xqdoc:description>list of files in directory $dir</xqdoc:description>
        <xqdoc:return>json array {name:"gg","path:"aaa/bb",isdir:false}</xqdoc:return>
      </xqdoc:comment>
      <xqdoc:name>df:list</xqdoc:name>
      <xqdoc:signature>declare function df:list($dir as xs:string) as element(_)*</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>dir</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type occurrence="*">element(_)</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="2">
      <xqdoc:comment>
        <xqdoc:description>list of files below directory $dir matching pattern</xqdoc:description>
        <xqdoc:return>json array {name:"gg","path:"aaa/bb",isdir:false}</xqdoc:return>
      </xqdoc:comment>
      <xqdoc:name>df:find</xqdoc:name>
      <xqdoc:signature>declare function df:find($dir as xs:string, $pattern as xs:string) as element(_)*</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>dir</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
        <xqdoc:parameter>
          <xqdoc:name>pattern</xqdoc:name>
          <xqdoc:type>xs:string</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type occurrence="*">element(_)</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="1">
      <xqdoc:comment>
        <xqdoc:description>get doc at dir as text, if xml convert to string</xqdoc:description>
      </xqdoc:comment>
      <xqdoc:name>df:read</xqdoc:name>
      <xqdoc:signature>declare function df:read($dir as item()*) as item()*</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>dir</xqdoc:name>
          <xqdoc:type occurrence="*">item()</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type occurrence="*">item()</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="1">
      <xqdoc:comment>
        <xqdoc:description>test file is text</xqdoc:description>
      </xqdoc:comment>
      <xqdoc:name>df:is-text-file</xqdoc:name>
      <xqdoc:signature>declare function df:is-text-file($path as item()*) as xs:boolean</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>path</xqdoc:name>
          <xqdoc:type occurrence="*">item()</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type>xs:boolean</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
    <xqdoc:function arity="1">
      <xqdoc:comment>
        <xqdoc:description>test for text</xqdoc:description>
        <xqdoc:see>http://stackoverflow.com/questions/2644938/how-to-tell-binary-from-text-files-in-linux</xqdoc:see>
      </xqdoc:comment>
      <xqdoc:name>df:is-text</xqdoc:name>
      <xqdoc:signature>declare function df:is-text($b as xs:base64Binary) as xs:boolean</xqdoc:signature>
      <xqdoc:parameters>
        <xqdoc:parameter>
          <xqdoc:name>b</xqdoc:name>
          <xqdoc:type>xs:base64Binary</xqdoc:type>
        </xqdoc:parameter>
      </xqdoc:parameters>
      <xqdoc:return>
        <xqdoc:type>xs:boolean</xqdoc:type>
      </xqdoc:return>
    </xqdoc:function>
  </xqdoc:functions>
</xqdoc:xqdoc>